#include "filter_1200.h"

static const float filter_taps[SAMPLEFILTER_TAP_NUM_1200] = {
 -0.002111249740406309,
  -0.0021120409213786972,
  -0.0030450185516041734,
  -0.004131544136670555,
  -0.005336806901169145,
  -0.006609271106123397,
  -0.007879214646991288,
  -0.009059310496992903,
  -0.010047056848442756,
  -0.010729487328653926,
  -0.010989531304150365,
  -0.010711369280267708,
  -0.009783850991094812,
  -0.00811236832235526,
  -0.0056270000832063715,
  -0.002282113965638473,
  0.0019331934453381994,
  0.006985200005869768,
  0.012809900157062747,
  0.01929333161283303,
  0.026289308129632306,
  0.0336145189768586,
  0.04105874167562655,
  0.04839283104042317,
  0.05537822963414002,
  0.06177755552741359,
  0.06736601727564909,
  0.07194368360465801,
  0.07534077266418887,
  0.07743174228012024,
  0.078137957016786,
  0.07743174228012024,
  0.07534077266418887,
  0.07194368360465801,
  0.06736601727564909,
  0.06177755552741359,
  0.05537822963414002,
  0.04839283104042317,
  0.04105874167562655,
  0.0336145189768586,
  0.026289308129632306,
  0.01929333161283303,
  0.012809900157062747,
  0.006985200005869768,
  0.0019331934453381994,
  -0.002282113965638473,
  -0.0056270000832063715,
  -0.00811236832235526,
  -0.009783850991094812,
  -0.010711369280267708,
  -0.010989531304150365,
  -0.010729487328653926,
  -0.010047056848442756,
  -0.009059310496992903,
  -0.007879214646991288,
  -0.006609271106123397,
  -0.005336806901169145,
  -0.004131544136670555,
  -0.0030450185516041734,
  -0.0021120409213786972,
  -0.002111249740406309
};

void SampleFilter_init_1200(SampleFilter* f) {
  int i;
  for(i = 0; i < SAMPLEFILTER_TAP_NUM_1200; ++i)
    f->history[i] = 0;
  f->last_index = 0;
}

void SampleFilter_put_1200(SampleFilter* f, float input) {
  f->history[f->last_index++] = input;
  if(f->last_index == SAMPLEFILTER_TAP_NUM_1200)
    f->last_index = 0;
}

float SampleFilter_get_1200(SampleFilter* f) {
  float acc = 0;
  int index = f->last_index, i;
  for(i = 0; i < SAMPLEFILTER_TAP_NUM_1200; ++i) {
    index = index != 0 ? index-1 : SAMPLEFILTER_TAP_NUM_1200-1;
    acc += f->history[index] * filter_taps[i];
  };
  return acc;
}
