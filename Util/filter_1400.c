#include "filter_1400.h"

static const float filter_taps[SAMPLEFILTER_TAP_NUM_1400] = {
  -0.002108581307718046,
  -0.0018715903819031688,
  -0.002582684218579511,
  -0.003360590751414715,
  -0.004161200833186238,
  -0.004925813490766663,
  -0.005584452738420613,
  -0.006054856529077616,
  -0.006248785148405207,
  -0.006072159897038977,
  -0.005434148956620989,
  -0.004250759712640026,
  -0.002450791173645613,
  0.000017461794738524598,
  0.003183107546031372,
  0.007048777316459338,
  0.011584510086543138,
  0.01672727185189692,
  0.022383013744971467,
  0.028427849410720005,
  0.03471014811714603,
  0.04105442251083089,
  0.04727346153454367,
  0.05317483095182682,
  0.05856404372541633,
  0.06325702425093091,
  0.0670959097428964,
  0.06993932800602494,
  0.07168903380385618,
  0.07227896297739654,
  0.07168903380385618,
  0.06993932800602494,
  0.0670959097428964,
  0.06325702425093091,
  0.05856404372541633,
  0.05317483095182682,
  0.04727346153454367,
  0.04105442251083089,
  0.03471014811714603,
  0.028427849410720005,
  0.022383013744971467,
  0.01672727185189692,
  0.011584510086543138,
  0.007048777316459338,
  0.003183107546031372,
  0.000017461794738524598,
  -0.002450791173645613,
  -0.004250759712640026,
  -0.005434148956620989,
  -0.006072159897038977,
  -0.006248785148405207,
  -0.006054856529077616,
  -0.005584452738420613,
  -0.004925813490766663,
  -0.004161200833186238,
  -0.003360590751414715,
  -0.002582684218579511,
  -0.0018715903819031688,
  -0.002108581307718046
};

void SampleFilter_init_1400(SampleFilter* f) {
  int i;
  for(i = 0; i < SAMPLEFILTER_TAP_NUM_1400; ++i)
    f->history[i] = 0;
  f->last_index = 0;
}

void SampleFilter_put_1400(SampleFilter* f, float input) {
  f->history[f->last_index++] = input;
  if(f->last_index == SAMPLEFILTER_TAP_NUM_1400)
    f->last_index = 0;
}

float SampleFilter_get_1400(SampleFilter* f) {
  float acc = 0;
  int index = f->last_index, i;
  for(i = 0; i < SAMPLEFILTER_TAP_NUM_1400; ++i) {
    index = index != 0 ? index-1 : SAMPLEFILTER_TAP_NUM_1400-1;
    acc += f->history[index] * filter_taps[i];
  };
  return acc;
}

